@page "/"
@using Blazor.Extensions; 
@using Blazor.Extensions.Canvas
@using Blazor.Extensions.Canvas.Canvas2D;
@using FamilyShow.Lib.Net7;
@inject NavigationManager Navigation

<InputFile OnChange="@LoadFiles" single />

@code {
    private async Task LoadFiles(InputFileChangeEventArgs e)
    {
        MemoryStream ms = new MemoryStream();
        await e.File.OpenReadStream().CopyToAsync(ms);
        ms.Position = 0;
        new GedcomImport().Import(GlobalState.Instance.PeopleCollection, ms);
        GlobalState.Instance.SelectedPerson = GlobalState.Instance.PeopleCollection[2];

        GlobalState.Instance.Families = new FamilyTreeCreator().CreateTree(GlobalState.Instance.PeopleCollection, GlobalState.Instance.SelectedPerson);

        Navigation.NavigateTo("/Counter");
    }
}
